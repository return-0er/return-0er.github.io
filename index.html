<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Capture, Download, and Fetch JSON</title>
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
</head>
<body>
    <button id="capture">Capture Element</button>
    <button id="download" style="display:none;">Download Image</button>
    <button id="fetchData">Fetch GitHub Data</button>

    <div id="element-to-capture" style="width: 200px; height: 200px; background: lightblue; margin-top: 20px;">
        This is the element to capture.
    </div>

    <div id="jsonOutput" style="margin-top: 20px; white-space: pre-wrap; background: #f0f0f0; padding: 10px; border: 1px solid #ddd;">
        <!-- JSON 数据将显示在这里 -->
    </div>

    <script>
        let imgData = '';

        document.getElementById('capture').addEventListener('click', function() {
            const element = document.getElementById('element-to-capture');
            html2canvas(element).then(canvas => {
                imgData = canvas.toDataURL('image/png');

                // 创建一个图片标签来显示生成的图片（可选）
                const img = document.createElement('img');
                img.src = imgData;
                document.body.appendChild(img);

                // 显示下载按钮
                document.getElementById('download').style.display = 'inline-block';
            });
        });

        document.getElementById('download').addEventListener('click', function() {
            const a = document.createElement('a');
            a.href = imgData;
            a.download = 'captured-image.png';  // 指定下载文件的名称
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);  // 下载后移除临时创建的链接
        });

        document.getElementById('fetchData').addEventListener('click', function() {
            fetch('https://api.github.com/repos/boybeak/JustTodo')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.json(); // 将响应解析为 JSON
                })
                .then(data => {
                    const jsonOutput = document.getElementById('jsonOutput');
                    jsonOutput.textContent = JSON.stringify(data, null, 2); // 格式化输出 JSON 数据
                })
                .catch(error => {
                    console.error('There was a problem with the fetch operation:', error);
                    const jsonOutput = document.getElementById('jsonOutput');
                    jsonOutput.textContent = `Error: ${error.message}`;
                });
        });
    </script>
</body>
</html>
